"use client"

import Link from 'next/link';
import Post from './Post';
import prisma from '@/lib/prisma'
import { Todo, columns } from '@/app/components/table-database/column';
import { useState, useEffect } from 'react';
import axios from 'axios';

// async function getPosts(){
//   const posts = await prisma.post.findMany({
//     where: {published: true},
//     include: {
//       author: {
//         select: {name: true}
//       }
//     }
//   })
//   return posts;
// }

export default function Home() {
  // const posts = await getPosts();
  const [data, setData] = useState<Todo[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
  const [error, setError] = useState<string | null>(null);
  const [errorBool, setErrorBool] = useState<boolean>(false);

  useEffect(() => {
    axios.get('/api/database')
    .then(response => {
      setData(response.data);
      setLoading(false);
    })
    .catch(error => {
      console.log('Error fetching post: ', error);
      setLoading(false);
      setError('Error fetching post: ' + error);
      setErrorBool(true);
    })
  }, []);

  if (loading) {
    return <div>Loading...</div>;
  }

  return (
    <main className=''>
      {/* <Link href={'/add-post'}>Add Post</Link> */}
      <h1>Todo List (Test Version)</h1>
      <div className="error">
        {errorBool && <p>{error}</p>}
      </div>
      {/* {
        posts.map((post) => {
          return (
            <Post
            key={post.id}
            id={post.id}
            title={post.title}
            content={post.content ?? ''}
            authorName={post.author ? post.author.name ?? '' : ''}
            />
          )
        })
      } */}
    </main>
  )
}